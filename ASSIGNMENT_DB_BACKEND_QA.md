# Assignment / Database / Backend Q&A (SmartRecruit AI)

> ูุฐุง ุงูููู ููุฎูุต ุฅุฌุงุจุงุช ุงูุฃุณุฆูุฉ ุจูุงุกู ุนูู ุงููุถุน ุงูุญุงูู ูู ุงููุดุฑูุน (ุงูููุฏ + `supabase_schema_refined.sql`).

## 1๏ธโฃ ุฃุณุฆูุฉ ุนู ูุงุนุฏุฉ ุงูุจูุงูุงุช
### ูุง ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุณุชุฎุฏูุฉุ
- **PostgreSQL ุนุจุฑ Supabase**

### ูู ุนูุฏู ุฌุฏูู `applications` ุฌุงูุฒุ
- **ูุนู**

### ูุง ูู ุงูุฃุนูุฏุฉ ุงูููุฌูุฏุฉ ูู `applications`ุ
- **id**: `uuid` (PK, default `gen_random_uuid()`)
- **job_form_id**: `uuid` (FK โ `job_forms.id`)
- **candidate_email**: `text`
- **candidate_name**: `text`
- **status**: `text` ุจููู ูุณููุญุฉ: `new|screening|interview|offer|hired|rejected|duplicate` (default `new`)
- **is_duplicate**: `boolean` (default `false`)
- **submitted_at**: `timestamptz`
- **created_at**: `timestamptz` (default `now()`)
- **updated_at**: `timestamptz` (default `now()`)

## 2๏ธโฃ ุฃุณุฆูุฉ ุนู ุงูู Backend Stack
### ูุง ูู ุงูุชูููุงุช ุงููุณุชุฎุฏูุฉ ูู ุงูู Backendุ
- **Next.js (App Router) + Server Actions**
- **Supabase Server Client** ููุงุณุชุนูุงูุงุช ุนูู PostgreSQL

> ูุง ููุฌุฏ ุนูุฏู ุญุงููุงู Express/NestJSุ ููุง ูู Supabase Edge Functions ูุฎุตุตุฉ ููุฐุง ุงูุฌุฒุก (ุญุณุจ ุงูููุฌูุฏ ุจุงููุดุฑูุน).

### ูู ุชุณุชุฎุฏู ORM ุฃู Query Builderุ
- **Supabase Client** (PostgREST) + ุจุนุถ SQL ูู ููู ุงูุณูููุง
- **ูุง ููุฌุฏ Prisma/TypeORM/Drizzle** ูู ูุฐุง ุงูุฌุฒุก

## 3๏ธโฃ ุฃุณุฆูุฉ ุนู Business Logic (Assignment)
### ูู ุงููููุฉ (Assignment) ูุงุญุฏุฉ ููู Application ุฃู ูุชุนุฏุฏุฉุ
ุญุณุจ ุงูุณูููุง ุงูุญุงููุฉ:
- ุฌุฏูู `assignments` ูุญุชูู `application_id` **ุจุฏูู** `UNIQUE`  
โก๏ธ ูุฐุง ูุนูู ุงูุนูุงูุฉ **One-to-Many** (ูููู ุนุฏุฉ Assignments ูููุณ `application_id`).

> ููุงุญุธุฉ: ุญุงููุงู ููุฒุฉ ุงููAssignments **ุบูุฑ ูุณุชุฎุฏูุฉ ุจุงููุงุฌูุฉ ููุง ุจุงูุจุงู ุงูุฏ** (ุฑุฌูุนูุงูุง ูุซู ูุง ูุงูุช)ุ ูุงูุฌุฏูู ููุฌูุฏ ููุท ูุณูููุง.

### ูู ุงููููุฉ ุฅูุฒุงููุฉ ุฏุงุฆูุงูุ
ุญุณุจ ุงูุณูููุง ุงูุญุงููุฉ:
- **ูุง ููุฌุฏ constraint** ููุฑุถ ูุฌูุฏ assignment ููู application  
โก๏ธ ุนูููุงู: **ุงุฎุชูุงุฑู** (Application ูููู ุจุฏูู Assignment).

## 4๏ธโฃ ุฃุณุฆูุฉ ุนู ุงูู API Endpoints
### ูุง ูู ุงูุนูููุงุช ุงููุทููุจุฉุ (ุจุงููุถุน ุงูุญุงูู)
ุญุงููุงู:
- **ูุง ููุฌุฏ endpoints/Server Actions ูุฎุตุตุฉ ูููassignments** (ุชู ุญุฐููุง ุจุงูุฑุฌูุน).

ุฅุฐุง ุจุฏูู ุชุฑุฌุนูุง ุงูููุฒุฉ ูุงุญูุงูุ ุงูุนูููุงุช ุงูููุทููุฉ ุนุงุฏุฉู:
- ูููAdmin/HR:
  - Create assignment
  - List assignments by application
  - Delete assignment (ุญุณุจ ุงูุฏูุฑ)
- ูููุชูุฏู:
  - ุนุงุฏุฉู ุงููุชูุฏู **ูุง ููุดุฆ assignments** (ูุฃูู ุชูููู ูู HR)ุ ุฅูุง ุฅุฐุง ุญุจูุชูุง ููููู ูุฎุชูู.

### ูู ุงููุชูุฏู ููุฏุฑ ูุนุฏู ุงููAssignment ุจุนุฏ ุงูุฅุฑุณุงูุ
ุจุงููุถุน ุงูุญุงูู ูุง ููุฌุฏ ูุณุงุฑ ููุฐุง.
ูู ุจุฏูู ุชุตููู MVP ุดุงุฆุน:
- **ูุง** (read-only ุจุนุฏ ุงูุฅูุดุงุก/ุงูุฅุฑุณุงู)

## 5๏ธโฃ ุฃุณุฆูุฉ ุนู ุงูู Validation
### ุงูุญูู `type` - ูุง ูู ุงูููู ุงููุณููุญุฉุ
ุจุงูุณูููุง ุงูุญุงููุฉ:
- `type` ูู `text` **ุจุฏูู enum/check**  
โก๏ธ ูุณููุญ ุฃู ูููุฉ ูุตูุฉ (ูููุถูู ูุงุญูุงู ุชูุญูุฏูุง ุจููู ุซุงุจุชุฉ).

### `text_fields` ูู ูู ุญุฏ ุฃูุตูุ
- `text` ูู PostgreSQL ุนูููุงู โุบูุฑ ูุญุฏูุฏโ (ุถูู ุญุฏูุฏ ุญุฌู ุงูุตู/TOAST)
- ูุง ูู constraint ูุญุฏุฏ ุจุงููุดุฑูุน

### `link_fields` ูุง ูู ุงูุดูู ุงููุชููุนุ
ุจุงูุณูููุง ุงูุญุงููุฉ:
- `link_fields` ูู `text` ููุท  
โก๏ธ ูุง ูู ุดูู ููุฑูุถ.
ุงูุชุฑุงุญุงุช ูู ุชุฑุฌุนูุง ุงูููุฒุฉ:
- `jsonb` array (ุฃูุถู) ุฃู ูุต ููุตูู ุจุฃุณุทุฑ/ููุงุตู ูุน validation ุจุงููุงุฌูุฉ.

## 6๏ธโฃ ุฃุณุฆูุฉ ุนู ุงูุนูุงูุงุช ูุน ุฌุฏุงูู ุฃุฎุฑู
### ูู ุฌุฏูู `job_forms` ููุฌูุฏุ
- **ูุนู** (`public.job_forms`) ููุฑุจูุท ุจู`applications.job_form_id`.

### ูู ูุญุชุงุฌ validation ุฃู ุงููJob ูุญุชูู ุนูู Assignment configurationุ
ุญุงููุงู:
- **ูุง ููุฌุฏ** ุนููุฏ/ุฅุนุฏุงุฏ ูู `job_forms` ููุฐุง
ูู ุจุฏูููุง:
- ุฅุถุงูุฉ `assignment_config jsonb` ุฃู `requires_assignment boolean` ูู `job_forms`.

### ูู ุฌุฏูู `ai_evaluations` ููุฌูุฏุ
- **ูุนู** (`public.ai_evaluations`) ูุฑุชุจุท ุจู`application_id`.

### ูู ูุญุชุงุฌ trigger/function ูุชุญุฏูุซ ุงูุชูููู ุนูุฏ ุฅุถุงูุฉ Assignmentุ
ุญุงููุงู:
- ูุง ูู triggers ููุฐุง.
ูู ุจุฏูููุง:
- ุงูุฃูุถู โJob asyncโ ุฃู โAdmin ุฒุฑ Evaluateโ ุจุฏู Trigger ูุจุงุดุฑ (ูุชุฌูุจ ุจุทุก transactions).

## 7๏ธโฃ ุฃุณุฆูุฉ ุนู ุงูุฃูุงู (Security)
### ูู ูุณุชุทูุนโฆุ (ุญุณุจ ุงููุถุน ุงูุญุงูู)
ูู ุงูุณูููุง ุงูุญุงููุฉ ูุฌุฏูู `assignments`:
- ููุฌุฏ ููุท policy: **"Staff can view assignments."** (ูุฑุงุกุฉ ููููุธููู)
- ูุง ููุฌุฏ policies ูุงุถุญุฉ ูููinsert/update/delete ุถูู ุงูุณูููุง ุงูุญุงููุฉ  
โก๏ธ ุนูููุงู: ุฃู ุนูููุงุช ูุชุงุจุฉ ูุงุฒู ุชูุฏุงุฑ ุจุณูุงุณุงุช ุฅุถุงููุฉ ูู ุจุฏูู ุชูุนูู ุงูููุฒุฉ.

## 8๏ธโฃ ุฃุณุฆูุฉ ุนู Error Handling
ุญุงููุงู ูุง ููุฌุฏ endpoints ูููassignmentุ ููู ูู ุชุฑุฌุน:
- ุฅุฐุง Assignment ุฅูุฒุงูู ููู ูุชู ุฅุฑุณุงูู: ุชุฑุฌูุน 400 + ุฑุณุงูุฉ ูุงุถุญุฉ
- ุฑูุงุจุท ุบูุฑ ุตุงูุญุฉ: 400 (validation)
- `application_id` ุบูุฑ ููุฌูุฏ: 404

## 9๏ธโฃ ุฃุณุฆูุฉ ุนู ุงูู AI Integration
ุญุงููุงู:
- ูุง ููุฌุฏ flow ูุจุงุดุฑ ูุฑุจุท Assignment ุจู AI.

ูู ุจุฏูู:
- Evaluate ุนูุฏ ุงูุฅุฑุณุงู asyncุ ุฃู Evaluate ุนูุฏ ุถุบุท Adminุ ุฃู ูุน ุงูุชูุงู Application.
- Endpoint/Action ูู:
  - Re-evaluate assignment
  - Get evaluation status

## ๐ ุฃุณุฆูุฉ ุนู TypeScript
ุญุงููุงู:
- ููุฌุฏ Types ุนุงูุฉ ูููุดุฑูุนุ ููู ูุง ููุฌุฏ Types/Validation ูุฎุตุตุฉ ูููassignments ูุฃู ุงูููุฒุฉ ุบูุฑ ููุนูุฉ.

ูู ุจุฏูู ุชูุนูููุง ูุงุญูุงูุ ุงูููุชุฑุญ:
- Types/interfaces + Zod schemas ููุชุญูู
- ุชูุซูู API (OpenAPI) ุฅุฐุง ูุงู ุนูุฏูู REST API ูููุตู








